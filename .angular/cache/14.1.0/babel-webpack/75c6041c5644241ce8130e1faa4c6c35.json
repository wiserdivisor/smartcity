{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n/**\n * @module ol/ImageTile\n */\n\n\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\nimport { createCanvasContext2D } from './dom.js';\nimport { listenImage } from './Image.js';\n\nvar ImageTile =\n/** @class */\nfunction (_super) {\n  __extends(ImageTile, _super);\n  /**\n   * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {import(\"./TileState.js\").default} state State.\n   * @param {string} src Image source URI.\n   * @param {?string} crossOrigin Cross origin.\n   * @param {import(\"./Tile.js\").LoadFunction} tileLoadFunction Tile load function.\n   * @param {import(\"./Tile.js\").Options} [opt_options] Tile options.\n   */\n\n\n  function ImageTile(tileCoord, state, src, crossOrigin, tileLoadFunction, opt_options) {\n    var _this = _super.call(this, tileCoord, state, opt_options) || this;\n    /**\n     * @private\n     * @type {?string}\n     */\n\n\n    _this.crossOrigin_ = crossOrigin;\n    /**\n     * Image URI\n     *\n     * @private\n     * @type {string}\n     */\n\n    _this.src_ = src;\n    _this.key = src;\n    /**\n     * @private\n     * @type {HTMLImageElement|HTMLCanvasElement}\n     */\n\n    _this.image_ = new Image();\n\n    if (crossOrigin !== null) {\n      _this.image_.crossOrigin = crossOrigin;\n    }\n    /**\n     * @private\n     * @type {?function():void}\n     */\n\n\n    _this.unlisten_ = null;\n    /**\n     * @private\n     * @type {import(\"./Tile.js\").LoadFunction}\n     */\n\n    _this.tileLoadFunction_ = tileLoadFunction;\n    return _this;\n  }\n  /**\n   * Get the HTML image element for this tile (may be a Canvas, Image, or Video).\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   * @api\n   */\n\n\n  ImageTile.prototype.getImage = function () {\n    return this.image_;\n  };\n  /**\n   * Sets an HTML image element for this tile (may be a Canvas or preloaded Image).\n   * @param {HTMLCanvasElement|HTMLImageElement} element Element.\n   */\n\n\n  ImageTile.prototype.setImage = function (element) {\n    this.image_ = element;\n    this.state = TileState.LOADED;\n    this.unlistenImage_();\n    this.changed();\n  };\n  /**\n   * Tracks loading or read errors.\n   *\n   * @private\n   */\n\n\n  ImageTile.prototype.handleImageError_ = function () {\n    this.state = TileState.ERROR;\n    this.unlistenImage_();\n    this.image_ = getBlankImage();\n    this.changed();\n  };\n  /**\n   * Tracks successful image load.\n   *\n   * @private\n   */\n\n\n  ImageTile.prototype.handleImageLoad_ = function () {\n    var image =\n    /** @type {HTMLImageElement} */\n    this.image_;\n\n    if (image.naturalWidth && image.naturalHeight) {\n      this.state = TileState.LOADED;\n    } else {\n      this.state = TileState.EMPTY;\n    }\n\n    this.unlistenImage_();\n    this.changed();\n  };\n  /**\n   * Load not yet loaded URI.\n   * @api\n   */\n\n\n  ImageTile.prototype.load = function () {\n    if (this.state == TileState.ERROR) {\n      this.state = TileState.IDLE;\n      this.image_ = new Image();\n\n      if (this.crossOrigin_ !== null) {\n        this.image_.crossOrigin = this.crossOrigin_;\n      }\n    }\n\n    if (this.state == TileState.IDLE) {\n      this.state = TileState.LOADING;\n      this.changed();\n      this.tileLoadFunction_(this, this.src_);\n      this.unlisten_ = listenImage(this.image_, this.handleImageLoad_.bind(this), this.handleImageError_.bind(this));\n    }\n  };\n  /**\n   * Discards event handlers which listen for load completion or errors.\n   *\n   * @private\n   */\n\n\n  ImageTile.prototype.unlistenImage_ = function () {\n    if (this.unlisten_) {\n      this.unlisten_();\n      this.unlisten_ = null;\n    }\n  };\n\n  return ImageTile;\n}(Tile);\n/**\n * Get a 1-pixel blank image.\n * @return {HTMLCanvasElement} Blank image.\n */\n\n\nfunction getBlankImage() {\n  var ctx = createCanvasContext2D(1, 1);\n  ctx.fillStyle = 'rgba(0,0,0,0)';\n  ctx.fillRect(0, 0, 1, 1);\n  return ctx.canvas;\n}\n\nexport default ImageTile;","map":{"version":3,"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","Tile","TileState","createCanvasContext2D","listenImage","ImageTile","_super","tileCoord","state","src","crossOrigin","tileLoadFunction","opt_options","_this","crossOrigin_","src_","key","image_","Image","unlisten_","tileLoadFunction_","getImage","setImage","element","LOADED","unlistenImage_","changed","handleImageError_","ERROR","getBlankImage","handleImageLoad_","image","naturalWidth","naturalHeight","EMPTY","load","IDLE","LOADING","bind","ctx","fillStyle","fillRect","canvas"],"sources":["/home/asura/github/smartcity/node_modules/ol/ImageTile.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * @module ol/ImageTile\n */\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\nimport { createCanvasContext2D } from './dom.js';\nimport { listenImage } from './Image.js';\nvar ImageTile = /** @class */ (function (_super) {\n    __extends(ImageTile, _super);\n    /**\n     * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n     * @param {import(\"./TileState.js\").default} state State.\n     * @param {string} src Image source URI.\n     * @param {?string} crossOrigin Cross origin.\n     * @param {import(\"./Tile.js\").LoadFunction} tileLoadFunction Tile load function.\n     * @param {import(\"./Tile.js\").Options} [opt_options] Tile options.\n     */\n    function ImageTile(tileCoord, state, src, crossOrigin, tileLoadFunction, opt_options) {\n        var _this = _super.call(this, tileCoord, state, opt_options) || this;\n        /**\n         * @private\n         * @type {?string}\n         */\n        _this.crossOrigin_ = crossOrigin;\n        /**\n         * Image URI\n         *\n         * @private\n         * @type {string}\n         */\n        _this.src_ = src;\n        _this.key = src;\n        /**\n         * @private\n         * @type {HTMLImageElement|HTMLCanvasElement}\n         */\n        _this.image_ = new Image();\n        if (crossOrigin !== null) {\n            _this.image_.crossOrigin = crossOrigin;\n        }\n        /**\n         * @private\n         * @type {?function():void}\n         */\n        _this.unlisten_ = null;\n        /**\n         * @private\n         * @type {import(\"./Tile.js\").LoadFunction}\n         */\n        _this.tileLoadFunction_ = tileLoadFunction;\n        return _this;\n    }\n    /**\n     * Get the HTML image element for this tile (may be a Canvas, Image, or Video).\n     * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n     * @api\n     */\n    ImageTile.prototype.getImage = function () {\n        return this.image_;\n    };\n    /**\n     * Sets an HTML image element for this tile (may be a Canvas or preloaded Image).\n     * @param {HTMLCanvasElement|HTMLImageElement} element Element.\n     */\n    ImageTile.prototype.setImage = function (element) {\n        this.image_ = element;\n        this.state = TileState.LOADED;\n        this.unlistenImage_();\n        this.changed();\n    };\n    /**\n     * Tracks loading or read errors.\n     *\n     * @private\n     */\n    ImageTile.prototype.handleImageError_ = function () {\n        this.state = TileState.ERROR;\n        this.unlistenImage_();\n        this.image_ = getBlankImage();\n        this.changed();\n    };\n    /**\n     * Tracks successful image load.\n     *\n     * @private\n     */\n    ImageTile.prototype.handleImageLoad_ = function () {\n        var image = /** @type {HTMLImageElement} */ (this.image_);\n        if (image.naturalWidth && image.naturalHeight) {\n            this.state = TileState.LOADED;\n        }\n        else {\n            this.state = TileState.EMPTY;\n        }\n        this.unlistenImage_();\n        this.changed();\n    };\n    /**\n     * Load not yet loaded URI.\n     * @api\n     */\n    ImageTile.prototype.load = function () {\n        if (this.state == TileState.ERROR) {\n            this.state = TileState.IDLE;\n            this.image_ = new Image();\n            if (this.crossOrigin_ !== null) {\n                this.image_.crossOrigin = this.crossOrigin_;\n            }\n        }\n        if (this.state == TileState.IDLE) {\n            this.state = TileState.LOADING;\n            this.changed();\n            this.tileLoadFunction_(this, this.src_);\n            this.unlisten_ = listenImage(this.image_, this.handleImageLoad_.bind(this), this.handleImageError_.bind(this));\n        }\n    };\n    /**\n     * Discards event handlers which listen for load completion or errors.\n     *\n     * @private\n     */\n    ImageTile.prototype.unlistenImage_ = function () {\n        if (this.unlisten_) {\n            this.unlisten_();\n            this.unlisten_ = null;\n        }\n    };\n    return ImageTile;\n}(Tile));\n/**\n * Get a 1-pixel blank image.\n * @return {HTMLCanvasElement} Blank image.\n */\nfunction getBlankImage() {\n    var ctx = createCanvasContext2D(1, 1);\n    ctx.fillStyle = 'rgba(0,0,0,0)';\n    ctx.fillRect(0, 0, 1, 1);\n    return ctx.canvas;\n}\nexport default ImageTile;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}